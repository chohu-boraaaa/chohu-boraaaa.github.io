---
layout: post  
title: "[ë°ì´í„°ë§ˆì´ë‹] 3ì¥. ë¡œì§€ìŠ¤í‹± íšŒê·€"
date: 2022-10-29
excerpt: "R ë°ì´í„°ë§ˆì´ë‹ì˜ 3ì¥ ë‚´ìš©ì„ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤."
tag:
- ë°ì´í„°ë§ˆì´ë‹
comments: true
--- 

# 3.1 ì„œë¡ 

---

- ë¡œì§€ìŠ¤í‹± íšŒê·€ : ë°˜ì‘ë³€ìˆ˜ê°€ ë²”ì£¼í˜•ì¸ ê²½ìš°(ì´ì§„í˜•ì¸ ê²½ìš°ê°€ ë§ìŒ) ì ìš©ë˜ëŠ” íšŒê·€ë¶„ì„ëª¨í˜•
- ì˜ˆì¸¡ëª¨í˜• : ìƒˆë¡œìš´ ì„¤ëª…ë³€ìˆ˜(ì˜ˆì¸¡ë³€ìˆ˜) ê°’ì´ ì£¼ì–´ì§ˆ ë•Œ ë°˜ì‘ë³€ìˆ˜ì˜ ê° ë²”ì£¼ì— ì†í•  í™•ë¥ ì„ ì¶”ì •
- ë¶„ë¥˜ëª¨í˜• : ì¶”ì •í™•ë¥ ì˜ ê¸°ì¤€ì¹˜ì— ë”°ë¼ ë¶„ë¥˜ì˜ ëª©ì ìœ¼ë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆìŒ
- ì‚¬í›„í™•ë¥  : ëª¨í˜•ì˜ ì í•©ì„ í†µí•´ ì¶”ì •ëœ í™•ë¥ 

# 3.2 ë¡œì§€ìŠ¤í‹± íšŒê·€

---

- ì´ì§„ë°˜ì‘ë³€ìˆ˜ Yì— ëŒ€í•´, ë‹¤ì¤‘ ë¡œì§€ìŠ¤í‹± íšŒê·€ëª¨í˜•ì˜ ì¼ë°˜ì  í˜•íƒœ
- yê°€ ë²”ì£¼í˜•ì¸ë° ì¼ë°˜ íšŒê·€ì í•©ì„ í•˜ë©´ (0 or 1 = -ë¬´í•œëŒ€ ~ ë¬´í•œëŒ€)ì˜ ì–‘ë³€ì˜ êµ¬ì¡°ì  ë¬¸ì œê°€ ë°œìƒí•˜ì—¬ ì˜¤ë¥˜ -> log(ì˜¤ì¦ˆ)ë¡œ êµ¬ì¡°ì  ë¬¸ì œ í•´ê²° ê°€ëŠ¥
- $log(ì˜¤ì¦ˆ)$

![](https://user-images.githubusercontent.com/77424107/198838476-bf6db2b2-bde4-4ece-aa18-850b2e91052b.png)
![](https://user-images.githubusercontent.com/77424107/198838544-a1885c06-b65f-4acd-99cd-7f536d81085d.png)

## âœ… ì¥ì  : ì˜¤ì¦ˆì˜ ê´€ì ì—ì„œ í•´ì„ ê°€ëŠ¥
- $exp(\beta_1)$ì˜ ì˜ë¯¸ : ë‚˜ë¨¸ì§€ ë³€ìˆ˜($x_2, ..., x_k$)ê°€ ì£¼ì–´ì§ˆ ë•Œ $x_1$ì´ í•œ ë‹¨ìœ„ ì¦ê°€í•  ë•Œë§ˆë‹¤ ì„±ê³µ(Y=1)ì˜ ì˜¤ì¦ˆê°€ ëª‡ ë°° ì¦ê°€í•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’

## âœ… ë‹¤ìŒì˜ ë°©ë²•ìœ¼ë¡œ ì¬í‘œí˜„ ê°€ëŠ¥

![](https://user-images.githubusercontent.com/77424107/198838897-89e88ed1-7c2d-4a3b-ab9d-9c87795a2f6a.png)

## âœ… ì˜ˆì¸¡ ë³€ìˆ˜ê°€ 1ê°œ vs 2ê°œì¸ ê²½ìš° ë¡œì§€ìŠ¤í‹± íšŒê·€ ì í•©í•œ ê²°ê³¼ ì‹œê°í™”

![](https://user-images.githubusercontent.com/77424107/198839127-22c15038-9437-48ac-99fb-7a12bd1d9160.png)

### âœ”ï¸ ë¡œì§€ìŠ¤í‹± íšŒê·€ì‹ì— ëŒ€í•œ ì˜ë¯¸ í•´ì„

#### 1ï¸âƒ£ ìœ„ ì‹ì€ ë‹¤ì¤‘ ë¡œì§€ìŠ¤í‹± íšŒê·€ í•¨ìˆ˜ì— í•´ë‹¹
- ê·¸ë˜í”„ í˜•íƒœ : ì„¤ëª…ë³€ìˆ˜ê°€ í•œ ê°œì¸ ê²½ìš°ì—” $\beta_1$ì˜ ë¶€í˜¸ì— ë”°ë¼ ê²°ì •
- $\beta_1$>0 : Sì ëª¨ì–‘
- $\beta_0$<0 : ì—­Sì ëª¨ì–‘

#### 2ï¸âƒ£ í‘œì¤€ ë¡œì§€ìŠ¤í‹± ë¶„í¬ì˜ ëˆ„ì ë¶„í¬í•¨ìˆ˜(cdf)ë¥¼ $F(x)$ë¼ê³  í•  ë•Œ ë™ì¼í•œ í‘œí˜„
- í‘œì¤€ë¡œì§€ìŠ¤í‹± ë¶„í¬ = $\alpha=0$, $\beta=1$ë¡œ í‘œì¤€í™”í•œ ë¡œì§€ìŠ¤í‹± ë¶„í¬ (L(0,1))
$$F(x)=\frac{e^x}{1+e^x}$$

![](https://user-images.githubusercontent.com/77424107/198839574-86c94768-0bcd-491f-946d-c644dfe1a717.png)

### âœ”ï¸ í”„ë¡œë¹— ëª¨í˜•
- ë¡œì§€ìŠ¤í‹± íšŒê·€ëª¨í˜•ê³¼ ìœ ì‚¬
- $F(.)$ ëŒ€ì‹  í‘œì¤€ì •ê·œë¶„í¬ì˜ ëˆ„ì í•¨ìˆ˜ $\phi(.)$ë¡œ ì„±ê³µì˜ í™•ë¥ ì„ ëª¨í˜•í™”í•œ ê²ƒ
$$\phi^{-1}(\pi(x))=\alpha+\beta_1x_1+...+\beta_kx_k$$

### âœ”ï¸ ë¡œì§€ìŠ¤í‹± íšŒê·€ì˜ ì´ìš©
- ë¶„ë¥˜ì˜ ëª©ì ìœ¼ë¡œ ì‚¬ìš©ë  ê²½ìš°ì—” $\pi(x)$ê°€ ê¸°ì¤€ê°’(ì˜ˆ. 1/2)ë³´ë‹¤ í¬ë©´ Y=1ì¸ ì§‘ë‹¨ìœ¼ë¡œ, ì‘ìœ¼ë©´ Y=0ì¸ ì§‘ë‹¨ìœ¼ë¡œ ë¶„ë¥˜
- ë¶„ë¥˜ ê¸°ì¤€ê°’ì˜ ê²°ì •ì€ ì‚¬ì „ì •ë³´ ë˜ëŠ” ì†ì‹¤í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ê±°ë‚˜ (ì •ë¶„ë¥˜ìœ¨, ë¯¼ê°ë„, íŠ¹ì´ë„)ë¥¼ ë™ì‹œì— ê³ ë ¤í•˜ëŠ” ë“± ë‹¤ì–‘í•œ ë°©ë²•ì´ ì‚¬ìš©ë¨

### âœ”ï¸ Rì—ì„œ ë¡œì§€ìŠ¤í‹± íšŒê·€ëª¨í˜• ì í•©
- glm() í•¨ìˆ˜

### ì˜ˆì œ1) ë°˜ì‘ë³€ìˆ˜ì˜ ë²”ì£¼ê°€ 2ê°œì¸ ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ iris ìë£Œì˜ ì¼ë¶€ë¶„ë§Œ ì´ìš©í•˜ê¸°ë¡œ í•¨. Speciesê°€ setosaì™€ versicolorì¸ 100ê°œ ìë£Œë§Œì„ ì´ìš©.
```
> data(iris)
> a <- subset(iris, Species == "setosa" | Species == "versicolor")
> a$Species <- factor(a$Species )
> str(a)
'data.frame':	100 obs. of  5 variables:
 $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : Factor w/ 2 levels "setosa","versicolor": 1 1 1 1 1 1 1 1 1 1 ... 
```
- ì´ ê²°ê³¼ì—ì„œ SpeciesëŠ” Factorí˜• ë³€ìˆ˜
- setosa : Y=1
- versicolor : Y=2
- ë¡œì§€ìŠ¤í‹± íšŒê·€ê°€ ì ìš©ë  ë•Œ, ë³´ë‹¤ í° ìˆ«ìì¸ versicolorì¼ ì˜¤ì¦ˆë¥¼ ëª¨í˜•í™”í•˜ë¯€ë¡œ í•´ì„ì— ìœ ì˜í•  í•„ìš”ê°€ ìˆìŒ
```
> b <- glm(Species~Sepal.Length, data=a, family=binomial) # check option family # glm() í•¨ìˆ˜ ì´ìš©í•˜ì—¬ ë¡œì§€ìŠ¤í‹± íšŒê·€ëª¨í˜• ì í•©
> summary(b) # summary model

Call:
glm(formula = Species ~ Sepal.Length, family = binomial, data = a)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.05501  -0.47395  -0.02829   0.39788   2.32915  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -27.831      5.434  -5.122 3.02e-07 ***
Sepal.Length    5.140      1.007   5.107 3.28e-07 ***
---
Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 138.629  on 99  degrees of freedom
Residual deviance:  64.211  on 98  degrees of freedom
AIC: 68.211

Number of Fisher Scoring iterations: 6
```
- íšŒê·€ê³„ìˆ˜ì˜ ê²€ì •ì—ì„œ p-ê°’ì´ ê±°ì˜ 0ì´ë¯€ë¡œ **Sepal.Length**ê°€ ë§¤ìš° ìœ ì˜í•œ ë³€ìˆ˜ì´ë©°, Sepal.Lengthê°€ í•œ ë‹¨ìœ„ ì¦ê°€í•¨ì— ë”°ë¼ versicolor(Y=2)ì¼ ì˜¤ì¦ˆê°€ exp(5.140), ëŒ€ëµ 170ë°° ì¦ê°€í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.
- Null deviance : ì ˆí¸ë§Œ í¬í•¨í•˜ëŠ” ëª¨í˜•($H_0:\beta=0$í•˜ì˜ ëª¨í˜•)ì˜ ì™„ì „ëª¨í˜•ìœ¼ë¡œë¶€í„°ì˜ ì´íƒˆë„(deviance), ìœ„ ê²°ê³¼ì—ì„œëŠ” p-ê°’=$P(\chi^2(99)>138.629)=0.005$ìœ¼ë¡œ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ë¯€ë¡œ **ì í•© ê²°ì—¬**ë¥¼ ë‚˜íƒ€ëƒ„.
- Residual deviance : ì˜ˆì¸¡ë³€ìˆ˜ Sepal.Lengthê°€ ì¶”ê°€ëœ ì í•©ëª¨í˜•ì˜ ì´íƒˆë„. Null devianceì— ë¹„í•´ ììœ ë„ 1 ê¸°ì¤€ì— ì´íƒˆë„ ê°ì†Œê°€ 74.4 ì •ë„ì˜ í° ê°ì†Œë¥¼ ë³´ì´ë©° p-ê°’=$P(\chi^2(98)>64.211)=0.997$ì´ë¯€ë¡œ ê·€ë¬´ê°€ì„¤(ì í•©ëª¨í˜•)ì´ ê¸°ê°ë˜ì§€ ì•Šê³  ì˜ ì í•©í•˜ê³  ìˆë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.
- ì™„ì „ëª¨í˜•(=í¬í™”ëª¨í˜•)ì— 100% ì„¤ëª…ë ¥ì„ ê°€ì§ = í†µê³„ì ìœ¼ë¡œ ë¬´ì˜ë¯¸í•¨
```
> coef(b) # íšŒê·€ê³„ìˆ˜ ë² íƒ€
 (Intercept) Sepal.Length 
  -27.831451     5.140336 
> exp(coef(b)["Sepal.Length"]) # oddsì˜ ì¦ê°€ëŸ‰ exp(ë² íƒ€)
Sepal.Length 
    170.7732 
> confint(b, parm = 'Sepal.Length') # íšŒê·€ê³„ìˆ˜ ë² íƒ€ ì‹ ë¢°êµ¬ê°„
í”„ë¡œíŒŒì¼ë§ì´ ì™„ë£Œë˜ê¸¸ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘ì…ë‹ˆë‹¤...
   2.5 %   97.5 % 
3.421613 7.415508 
> exp(confint(b, parm= 'Sepal.Length')) # oddsì˜ ì¦ê°€ëŸ‰ exp(ë² íƒ€) ì‹ ë¢°êµ¬ê°„
í”„ë¡œíŒŒì¼ë§ì´ ì™„ë£Œë˜ê¸¸ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘ì…ë‹ˆë‹¤...
     2.5 %     97.5 % 
  30.61878 1661.55385 
> fitted(b)[c(1:5, 96:100)] # fitted í•¨ìˆ˜ë¥¼ í†µí•´ ì í•©ê²°ê³¼ í™•ì¸
         1          2          3          4          5         96         97 
0.16579367 0.06637193 0.02479825 0.01498061 0.10623680 0.81282396 0.81282396 
        98         99        100 
0.98268360 0.16579367 0.81282396 
> # predict() í•¨ìˆ˜ ì´ìš©í•˜ì—¬ ìƒˆë¡œìš´ ìë£Œì— ëŒ€í•œ ì˜ˆì¸¡ ìˆ˜í–‰
> # ì—¬ê¸°ì—ì„œëŠ” í¸ì˜ìƒ ëª¨í˜•êµ¬ì¶•ì— ì‚¬ìš©ëœ ìë£Œ ì¬ì‚¬ìš©
> predict(b, newdata=a [c(1, 50, 51, 100), ], type="response" )
        1        50        51       100 
0.1657937 0.1062368 0.9997116 0.8128240 
```

#### ğŸ’œ cdplot() í•¨ìˆ˜ : Sepal.Length(ì—°ì†í˜•)ì˜ ë³€í™”ì— ë”°ë¥¸ ë²”ì£¼í˜• ë³€ìˆ˜ì˜ ì¡°ê±´ë¶€ ë¶„í¬ë¥¼ ë³´ì—¬ì¤Œ. 
```
> cdplot(Species~Sepal.Length, data=a)
```
![](https://user-images.githubusercontent.com/77424107/198864599-2396df51-22bf-4422-83d4-6c0a3235d4f3.png)

- Sepal.Legnthê°€ ì»¤ì§ì— ë”°ë¼ ì•„ë˜ìª½ ì˜ì—­ì¸ versicolorì˜ í™•ë¥ ì´ ì¦ê°€
- cdplot() í•¨ìˆ˜ëŠ” ë¡œì§€ìŠ¤í‹± íšŒê·€ì˜ íƒìƒ‰ì  ë¶„ì„ì— ìœ ìš©

#### ğŸ’œ ì í•©ëœ ë¡œì§€ìŠ¤í‹± íšŒê·€ëª¨í˜• ê·¸ë˜í”„
```
> plot(a$Sepal.Length, a$Species, xlab="Sepal.Length")
> x=seq(min(a$Sepal.Length), max(a$Sepal.Length), 0.1)
> lines(x, 1+(1/(1+(1/exp(-27.831+5.140*x)))), type="l", col="red")
```
![](https://user-images.githubusercontent.com/77424107/198864768-13d7c636-910b-4c4c-b138-1454a8c6c69d.png)
- ê·¸ë˜í”„ ê·¸ë¦´ ë•Œ $\pi(x)$ì— 1+ ë¥¼ ì¶”ê°€í•´ì¤€ ì´ìœ  : ì¶”ì •ëœ í™•ë¥ ì˜ ë²”ìœ„ë¥¼ (0,1)ì—ì„œ (1,2)ë¡œ ë³€ê²½í•´ì£¼ê¸° ìœ„í•¨

### ì˜ˆì œ 2) ì˜ˆì¸¡ë³€ìˆ˜ê°€ ì—¬ëŸ¬ ê°œì¸ ë‹¤ì¤‘ ë¡œì§€ìŠ¤í‹± íšŒê·€ëª¨í˜• ì í•© : ë¶„ì„ì— ì‚¬ìš©ë˜ëŠ” ìë£ŒëŠ” 1973~1974ë„ì— ìƒì‚°ëœ 32ì¢…ë¥˜ì˜ ìë™ì°¨ì— ëŒ€í•´ 11ê°œ ë³€ìˆ˜ë¥¼ ì¸¡ì •í•œ ìë£Œ
```
> attach(mtcars)
> str(mtcars)
'data.frame':	32 obs. of  11 variables:
 $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
 $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
 $ disp: num  160 160 108 258 360 ...
 $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
 $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
 $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
 $ qsec: num  16.5 17 18.6 19.4 17 ...
 $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
 $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
 $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
 $ carb: num  4 4 1 1 2 1 4 2 2 4 ...
```
- ì´í•­ë³€ìˆ˜ vsë¥¼ ë°˜ì‘ë³€ìˆ˜ë¡œ, mpgì™€ amì„ ì˜ˆì¸¡ë³€ìˆ˜ë¡œ í•˜ëŠ” ë¡œì§€ìŠ¤í‹± íšŒê·€ëª¨í˜• ì í•©
```
> # family=binomialëŠ” family=binomial(logit)ê³¼ ë™ì¼
> glm.vs <- glm(vs~mpg+am, data=mtcars, family=binomial) 
> summary(glm.vs)

Call:
glm(formula = vs ~ mpg + am, family = binomial, data = mtcars)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.05888  -0.44544  -0.08765   0.33335   1.68405  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)   
(Intercept) -12.7051     4.6252  -2.747  0.00602 **
mpg           0.6809     0.2524   2.698  0.00697 **
am           -3.0073     1.5995  -1.880  0.06009 . 
---
Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 43.860  on 31  degrees of freedom
Residual deviance: 20.646  on 29  degrees of freedom
AIC: 26.646

Number of Fisher Scoring iterations: 6
```

#### ğŸ’œ ì¶”ì •ëœ íšŒê·€ê³„ìˆ˜ $\hat{\beta_1}$ì— ëŒ€í•œ í•´ì„
- ë‹¤ë¥¸ ëª¨ë“  ë³€ìˆ˜ë“¤ì´ ì£¼ì–´ì§ˆ ë•Œ, mpg ê°’ì´ í•œ ë‹¨ìœ„ ì¦ê°€í•¨ì— ë”°ë¼ vsê°€ 1ì¼ ì˜¤ì¦ˆê°€ exp(0.6809) = 1.98ë°°(98%) ì¦ê°€
- ë‹¤ë¥¸ ëª¨ë“  ë³€ìˆ˜ë“¤ì´ ì£¼ì–´ì§ˆ ë•Œ, am ê°’ì´ í•œ ë‹¨ìœ„ ì¦ê°€í•¨ì— ë”°ë¼ vsê°€ 1ì¼ ì˜¤ì¦ˆê°€ exp(-3.0073) = 0.05ë°° ì¦ê°€ = ë³€ì†ê¸°ê°€ ìˆ˜ë™ì¸ ê²½ìš° ìë™ì— ë¹„í•´ vs=1ì˜ ì˜¤ì¦ˆê°€ 95% ê°ì†Œ

#### ğŸ’œ ì˜ˆì¸¡ë³€ìˆ˜ê°€ ì—¬ëŸ¬ ê°œì¸ ëª¨í˜• ì í•©ì‹œ ë³€ìˆ˜ì„ íƒë²• ì ìš©
- direction= ì˜µì…˜ : 'both'(stepwise), 'backward'(ë””í´íŠ¸, í›„ì§„ì„ íƒë²•), 'forward'(ì „ì§„ì„ íƒë²•)
- ì „ì§„ì„ íƒë²• : ì ˆí¸í•­ë§Œ í¬í•¨í•˜ëŠ” ê°€ì¥ ì‘ì€ ëª¨í˜•ì—ì„œ ë°˜ì‘ë³€ìˆ˜ì— ê°€ì¥ í° ì˜í–¥ì„ ì£¼ëŠ” ì„¤ëª…ë³€ìˆ˜ë¥¼ ì°¨ë¡€ë¡œ ëª¨í˜•ì— í¬í•¨ì‹œì¼œë‚˜ê°€ë˜ ë” ì´ìƒ ì˜ë¯¸ ìˆëŠ” ë³€ìˆ˜ê°€ ì—†ì„ ë•Œ ì¤‘ë‹¨í•˜ëŠ” ë°©ë²•
- í›„ì§„ì œê±°ë²• : ëª¨ë“  ì„¤ëª…ë³€ìˆ˜ë¥¼ í¬í•¨í•˜ëŠ” ëª¨í˜•ì—ì„œ ê¸°ì—¬ë„ê°€ ë‚®ì€ ë³€ìˆ˜ë¥¼ ì°¨ë¡€ë¡œ ì œê±°í•´ ë‚˜ê°€ë˜ ë” ì´ìƒ ì œê±°í•  ë³€ìˆ˜ê°€ ì—†ìœ¼ë©´ ì¤‘ë‹¨í•˜ëŠ” ê¸°ë²•
- ë‹¨ê³„ë³„ ì„ íƒë²• : ì „ì§„ì„ íƒë²•ì—ì„œ í•œ ë²ˆ ì„ íƒëœ ë³€ìˆ˜ëŠ” ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ì œê±°ë  ê¸°íšŒë¥¼ ê°–ì§€ ëª»í•˜ê³ , í›„ì§„ì œê±°ë²•ì—ì„œ í•œ ë²ˆ ì œê±°ëœ ë³€ìˆ˜ëŠ” ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ì„ íƒë  ê¸°íšŒë¥¼ ê°–ì§€ ëª»í•œë‹¤. ì´ëŸ° ë‹¨ì ì„ ë³´ì™„í•˜ê³ ì ë¨¼ì € ì„ íƒëœ ë³€ìˆ˜ë„ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ì œê±°ë  ìˆ˜ ìˆë„ë¡ ë³€ìˆ˜ì„ íƒì˜ ë‹¨ê³„ë§ˆë‹¤ ì²´í¬í•˜ëŠ” ë°©ë²•.
```
> step.vs <- step(glm.vs, direction="backward")
Start:  AIC=26.65
vs ~ mpg + am

       Df Deviance    AIC
<none>      20.646 26.646
- am    1   25.533 29.533
- mpg   1   42.953 46.953
> summary(step.vs) # summary(glm.vs)ì™€ ê²°ê³¼ ë™ì¼

Call:
glm(formula = vs ~ mpg + am, family = binomial, data = mtcars)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.05888  -0.44544  -0.08765   0.33335   1.68405  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)   
(Intercept) -12.7051     4.6252  -2.747  0.00602 **
mpg           0.6809     0.2524   2.698  0.00697 **
am           -3.0073     1.5995  -1.880  0.06009 . 
---
Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 43.860  on 31  degrees of freedom
Residual deviance: 20.646  on 29  degrees of freedom
AIC: 26.646

Number of Fisher Scoring iterations: 6

```

#### ğŸ’œ glm() í•¨ìˆ˜ì˜ ìœ ìš©í•œ ìˆ˜í–‰ ê²°ê³¼ë“¤ ì˜ˆì‹œ
```
> ls(glm.vs)
 [1] "aic"               "boundary"          "call"             
 [4] "coefficients"      "contrasts"         "control"          
 [7] "converged"         "data"              "deviance"         
[10] "df.null"           "df.residual"       "effects"          
[13] "family"            "fitted.values"     "formula"          
[16] "iter"              "linear.predictors" "method"           
[19] "model"             "null.deviance"     "offset"           
[22] "prior.weights"     "qr"                "R"                
[25] "rank"              "residuals"         "terms"            
[28] "weights"           "xlevels"           "y"                
> str(glm.vs)
List of 30
 $ coefficients     : Named num [1:3] -12.705 0.681 -3.007
  ..- attr(*, "names")= chr [1:3] "(Intercept)" "mpg" "am"
 $ residuals        : Named num [1:32] -1.24 -1.24 2.21 1.15 -2.03 ...
  ..- attr(*, "names")= chr [1:32] "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" "Hornet 4 Drive" ...
 $ fitted.values    : Named num [1:32] 0.196 0.196 0.453 0.866 0.507 ...
  ..- attr(*, "names")= chr [1:32] "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" "Hornet 4 Drive" ...
 $ effects          : Named num [1:32] 0.726 -1.939 1.88 0.932 -0.658 ...
  ..- attr(*, "names")= chr [1:32] "(Intercept)" "mpg" "am" "" ...
 $ R                : num [1:3, 1:3] -1.8 0 0 -35.07 -5.29 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:3] "(Intercept)" "mpg" "am"
  .. ..$ : chr [1:3] "(Intercept)" "mpg" "am"
 $ rank             : int 3
 $ qr               :List of 5
  ..$ qr   : num [1:32, 1:3] -1.804 0.22 0.276 0.189 0.277 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:32] "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" "Hornet 4 Drive" ...
  .. .. ..$ : chr [1:3] "(Intercept)" "mpg" "am"
  ..$ rank : int 3
  ..$ qraux: num [1:3] 1.22 1.1 1.12
  ..$ pivot: int [1:3] 1 2 3
  ..$ tol  : num 1e-11
  ..- attr(*, "class")= chr "qr"
 $ family           :List of 12
  ..$ family    : chr "binomial"
  ..$ link      : chr "logit"
  ..$ linkfun   :function (mu)  
  ..$ linkinv   :function (eta)  
  ..$ variance  :function (mu)  
  ..$ dev.resids:function (y, mu, wt)  
  ..$ aic       :function (y, n, mu, wt, dev)  
  ..$ mu.eta    :function (eta)  
  ..$ initialize: language {     if (NCOL(y) == 1) { ...
  ..$ validmu   :function (mu)  
  ..$ valideta  :function (eta)  
  ..$ simulate  :function (object, nsim)  
  ..- attr(*, "class")= chr "family"
 $ linear.predictors: Named num [1:32] -1.4131 -1.4131 -0.1874 1.8666 0.0281 ...
  ..- attr(*, "names")= chr [1:32] "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" "Hornet 4 Drive" ...
 $ deviance         : num 20.6
 $ aic              : num 26.6
 $ null.deviance    : num 43.9
 $ iter             : int 6
 $ weights          : Named num [1:32] 0.157 0.157 0.248 0.116 0.25 ...
  ..- attr(*, "names")= chr [1:32] "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" "Hornet 4 Drive" ...
 $ prior.weights    : Named num [1:32] 1 1 1 1 1 1 1 1 1 1 ...
  ..- attr(*, "names")= chr [1:32] "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" "Hornet 4 Drive" ...
 $ df.residual      : int 29
 $ df.null          : int 31
 $ y                : Named num [1:32] 0 0 1 1 0 1 0 1 1 1 ...
  ..- attr(*, "names")= chr [1:32] "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" "Hornet 4 Drive" ...
 $ converged        : logi TRUE
 $ boundary         : logi FALSE
 $ model            :'data.frame':	32 obs. of  3 variables:
  ..$ vs : num [1:32] 0 0 1 1 0 1 0 1 1 1 ...
  ..$ mpg: num [1:32] 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
  ..$ am : num [1:32] 1 1 1 0 0 0 0 0 0 0 ...
  ..- attr(*, "terms")=Classes 'terms', 'formula'  language vs ~ mpg + am
  .. .. ..- attr(*, "variables")= language list(vs, mpg, am)
  .. .. ..- attr(*, "factors")= int [1:3, 1:2] 0 1 0 0 0 1
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. ..$ : chr [1:3] "vs" "mpg" "am"
  .. .. .. .. ..$ : chr [1:2] "mpg" "am"
  .. .. ..- attr(*, "term.labels")= chr [1:2] "mpg" "am"
  .. .. ..- attr(*, "order")= int [1:2] 1 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=<environment: R_GlobalEnv> 
  .. .. ..- attr(*, "predvars")= language list(vs, mpg, am)
  .. .. ..- attr(*, "dataClasses")= Named chr [1:3] "numeric" "numeric" "numeric"
  .. .. .. ..- attr(*, "names")= chr [1:3] "vs" "mpg" "am"
 $ call             : language glm(formula = vs ~ mpg + am, family = binomial, data = mtcars)
 $ formula          :Class 'formula'  language vs ~ mpg + am
  .. ..- attr(*, ".Environment")=<environment: R_GlobalEnv> 
 $ terms            :Classes 'terms', 'formula'  language vs ~ mpg + am
  .. ..- attr(*, "variables")= language list(vs, mpg, am)
  .. ..- attr(*, "factors")= int [1:3, 1:2] 0 1 0 0 0 1
  .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. ..$ : chr [1:3] "vs" "mpg" "am"
  .. .. .. ..$ : chr [1:2] "mpg" "am"
  .. ..- attr(*, "term.labels")= chr [1:2] "mpg" "am"
  .. ..- attr(*, "order")= int [1:2] 1 1
  .. ..- attr(*, "intercept")= int 1
  .. ..- attr(*, "response")= int 1
  .. ..- attr(*, ".Environment")=<environment: R_GlobalEnv> 
  .. ..- attr(*, "predvars")= language list(vs, mpg, am)
  .. ..- attr(*, "dataClasses")= Named chr [1:3] "numeric" "numeric" "numeric"
  .. .. ..- attr(*, "names")= chr [1:3] "vs" "mpg" "am"
 $ data             :'data.frame':	32 obs. of  11 variables:
  ..$ mpg : num [1:32] 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
  ..$ cyl : num [1:32] 6 6 4 6 8 6 8 4 4 6 ...
  ..$ disp: num [1:32] 160 160 108 258 360 ...
  ..$ hp  : num [1:32] 110 110 93 110 175 105 245 62 95 123 ...
  ..$ drat: num [1:32] 3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
  ..$ wt  : num [1:32] 2.62 2.88 2.32 3.21 3.44 ...
  ..$ qsec: num [1:32] 16.5 17 18.6 19.4 17 ...
  ..$ vs  : num [1:32] 0 0 1 1 0 1 0 1 1 1 ...
  ..$ am  : num [1:32] 1 1 1 0 0 0 0 0 0 0 ...
  ..$ gear: num [1:32] 4 4 4 3 3 3 3 4 4 4 ...
  ..$ carb: num [1:32] 4 4 1 1 2 1 4 2 2 4 ...
 $ offset           : NULL
 $ control          :List of 3
  ..$ epsilon: num 1e-08
  ..$ maxit  : num 25
  ..$ trace  : logi FALSE
 $ method           : chr "glm.fit"
 $ contrasts        : NULL
 $ xlevels          : Named list()
 - attr(*, "class")= chr [1:2] "glm" "lm"
```

#### ğŸ’œ anova() í•¨ìˆ˜ : ëª¨í˜•ì˜ ì í•©(ë³€ìˆ˜ê°€ ì¶”ê°€ë˜ëŠ”) ë‹¨ê³„ë³„ë¡œ ì´íƒˆë„ì˜ ê°ì†ŒëŸ‰ê³¼ ìœ ì˜ì„±ê²€ì¦ ê²°ê³¼ë¥¼ ì œì‹œ
```
> anova(glm.vs, test="Chisq")
Analysis of Deviance Table

Model: binomial, link: logit

Response: vs

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                    31     43.860              
mpg   1   18.327        30     25.533 1.861e-05 ***
am    1    4.887        29     20.646   0.02706 *  
---
Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
```
- ì ˆí¸í•­ë§Œì„ í¬í•¨í•˜ëŠ” ì˜ëª¨í˜•ì—ì„œ mpg, am ë³€ìˆ˜ê°€ ì°¨ë¡€ë¡œ ì¶”ê°€ë¨ì— ë”°ë¼ ë°œìƒí•˜ëŠ” ì´íƒˆë„ ê°ì†ŒëŸ‰ ì œì‹œ
- p-ê°’ì€ ê°ê° $P(\chi^2(1)>18.327)$ê³¼ $P(\chi^2(1)>4.887)$ì„ ê³„ì‚°í•œ ê°’
- ë‘ ë³€ìˆ˜ê°€ ì°¨ë¡€ë¡œ ì¶”ê°€ë˜ë©´ì„œ ìƒê²¨ë‚˜ëŠ” ì´íƒˆë„ì˜ ê°ì†ŒëŸ‰ì´ ëª¨ë‘ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•¨
```
> 1-pchisq(18.327, 1) # p-value
[1] 1.860515e-05
> 1-pchisq(4.887, 1) # p-value
[1] 0.02705967
```

# ì°¸ê³  1) ë¡œì§€ìŠ¤í‹± íšŒê·€ëª¨í˜• = ë¡œì§“ ëª¨í˜•
- ì¼ë°˜í™”ì„ í˜•ëª¨í˜•ì˜ íŠ¹ë³„í•œ ê²½ìš°
- ë°˜ì‘ë³€ìˆ˜ì˜ ë²”ì£¼ê°€ 3ê°œ ì´ìƒì¸ ê²½ìš°ì—ëŠ” ë²”ì£¼ì˜ ìœ í˜•(ëª…ëª©í˜• ë˜ëŠ” ìˆœì„œí˜•)ì— ë”°ë¼ ë‹¤ì–‘í•œ ë‹¤ë²”ì£¼ ë¡œì§“ëª¨í˜• ì í•© ê°€ëŠ¥

# ì°¸ê³  2) ì¼ë°˜í™”ì„ í˜•ëª¨í˜•(GLM)ì—ì„œì˜ ì´íƒˆë„(deviance)
- Null Deviance : ì ˆí¸ëª¨í˜•ì˜ ì™„ì „ëª¨í˜•ìœ¼ë¡œë¶€í„°ì˜ ì´íƒˆë„
$$Null Deviance = 2[LL(í¬í™”ëª¨í˜•)-LL(ì˜ëª¨í˜•)], df=n-1$$
- Residual Deviance : ì œì•ˆëª¨í˜•ì˜ ì™„ì „ëª¨í˜•ìœ¼ë¡œë¶€í„°ì˜ ì´íƒˆë„
$$Residual Deviance = 2[LL(í¬í™”ëª¨í˜•)-LL(ì œì•ˆëª¨í˜•)], df=n-(p+1)$$
- LL = ë¡œê·¸ê°€ëŠ¥ë„
- ì´íƒˆë„ ê°’ì´ ì‘ì„ìˆ˜ë¡ í•´ë‹¹ëª¨í˜•ì´ ìë£Œë¥¼ ì˜ ì í•©í•¨ì„ ì˜ë¯¸
- ê²€ì •: ë‘ ì¢…ë¥˜ì˜ Devianceê°€ í•´ë‹¹ëª¨í˜•ì´ ì°¸ì¼ ë•Œ, ê·¼ì‚¬ì ìœ¼ë¡œ ì¹´ì´ì œê³±ë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ëŠ” ì‚¬ì‹¤ì— ê¸°ì´ˆí•˜ê³  **ììœ ë„ëŠ” (í¬í™”ëª¨í˜• ëª¨ìˆ˜ì˜ ìˆ˜ - í•´ë‹¹ ëª¨í˜• ëª¨ìˆ˜ì˜ ìˆ˜)**

## âœ… ì˜ëª¨í˜•ê³¼ ì œì•ˆëª¨í˜• ê°„ ë¹„êµ(ê²€ì •)
- (Null Deviance - Proposed Deviance)ê°€ ê·¼ì‚¬ì ìœ¼ë¡œ ììœ ë„ê°€ (n-(p+1))-(n-1)=pì¸ ì¹´ì´ì œê³±ë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ëŠ” ì‚¬ì‹¤ì— ê¸°ì´ˆ

## 1ï¸âƒ£ í¬í™”ëª¨í˜•(Saturated Model)
- ì¶”ì •í•´ì•¼ í•  ëª¨ìˆ˜ì˜ ìˆ˜ê°€ ë°ì´í„° ìˆ˜ì™€ ë™ì¼í•œ ëª¨í˜•
- ì™„ì „ ëª¨í˜•(Full Model)

## 2ï¸âƒ£ ì˜ëª¨í˜•(Null Model)
- ì ˆí¸í•­ë§Œ ê°€ì§€ëŠ” ëª¨í˜•
- ì¶”ì •í•  ëª¨ìˆ˜ê°€ 1ê°œ

## 3ï¸âƒ£ ì œì•ˆëª¨í˜•(Purposed Model)
- (pê°œì˜ ëª¨ìˆ˜+ì ˆí¸í•­)ì„ í¬í•¨í•˜ëŠ” ëª¨í˜•
- ì¶”ì •í•  ëª¨ìˆ˜ê°€ p+1ê°œ 

# ì°¸ê³  3) ë¡œì§“ ë³€í™˜
![](https://bokyeong-kim.github.io/assets/img/logit(3).png)