---
layout: post  
title: "[데이터마이닝] 3장. 로지스틱 회귀"
date: 2022-10-29
excerpt: "R 데이터마이닝의 3장 내용을 정리하였습니다."
tag:
- 데이터마이닝
comments: true
--- 

# 3.1 서론

---

- 로지스틱 회귀 : 반응변수가 범주형인 경우(이진형인 경우가 많음) 적용되는 회귀분석모형
- 예측모형 : 새로운 설명변수(예측변수) 값이 주어질 때 반응변수의 각 범주에 속할 확률을 추정
- 분류모형 : 추정확률의 기준치에 따라 분류의 목적으로 사용될 수 있음
- 사후확률 : 모형의 적합을 통해 추정된 확률

# 3.2 로지스틱 회귀

---

- 이진반응변수 Y에 대해, 다중 로지스틱 회귀모형의 일반적 형태
- y가 범주형인데 일반 회귀적합을 하면 (0 or 1 = -무한대 ~ 무한대)의 양변의 구조적 문제가 발생하여 오류 -> log(오즈)로 구조적 문제 해결 가능
- $log(오즈)$

![](https://user-images.githubusercontent.com/77424107/198838476-bf6db2b2-bde4-4ece-aa18-850b2e91052b.png)
![](https://user-images.githubusercontent.com/77424107/198838544-a1885c06-b65f-4acd-99cd-7f536d81085d.png)

## ✅ 장점 : 오즈의 관점에서 해석 가능
- $exp(\beta_1)$의 의미 : 나머지 변수($x_2, ..., x_k$)가 주어질 때 $x_1$이 한 단위 증가할 때마다 성공(Y=1)의 오즈가 몇 배 증가하는지를 나타내는 값

## ✅ 다음의 방법으로 재표현 가능

![](https://user-images.githubusercontent.com/77424107/198838897-89e88ed1-7c2d-4a3b-ab9d-9c87795a2f6a.png)

## ✅ 예측 변수가 1개 vs 2개인 경우 로지스틱 회귀 적합한 결과 시각화

![](https://user-images.githubusercontent.com/77424107/198839127-22c15038-9437-48ac-99fb-7a12bd1d9160.png)

### ✔️ 로지스틱 회귀식에 대한 의미 해석

#### 1️⃣ 위 식은 다중 로지스틱 회귀 함수에 해당
- 그래프 형태 : 설명변수가 한 개인 경우엔 $\beta_1$의 부호에 따라 결정
- $\beta_1$>0 : S자 모양
- $\beta_0$<0 : 역S자 모양

#### 2️⃣ 표준 로지스틱 분포의 누적분포함수(cdf)를 $F(x)$라고 할 때 동일한 표현
- 표준로지스틱 분포 = $\alpha=0$, $\beta=1$로 표준화한 로지스틱 분포 (L(0,1))
$$F(x)=\frac{e^x}{1+e^x}$$

![](https://user-images.githubusercontent.com/77424107/198839574-86c94768-0bcd-491f-946d-c644dfe1a717.png)

### ✔️ 프로빗 모형
- 로지스틱 회귀모형과 유사
- $F(.)$ 대신 표준정규분포의 누적함수 $\phi(.)$로 성공의 확률을 모형화한 것
$$\phi^{-1}(\pi(x))=\alpha+\beta_1x_1+...+\beta_kx_k$$

### ✔️ 로지스틱 회귀의 이용
- 분류의 목적으로 사용될 경우엔 $\pi(x)$가 기준값(예. 1/2)보다 크면 Y=1인 집단으로, 작으면 Y=0인 집단으로 분류
- 분류 기준값의 결정은 사전정보 또는 손실함수를 이용하거나 (정분류율, 민감도, 특이도)를 동시에 고려하는 등 다양한 방법이 사용됨

### ✔️ R에서 로지스틱 회귀모형 적합
- glm() 함수

### 예제1) 반응변수의 범주가 2개인 로지스틱 회귀를 적용하기 위해 iris 자료의 일부분만 이용하기로 함. Species가 setosa와 versicolor인 100개 자료만을 이용.
```
> data(iris)
> a <- subset(iris, Species == "setosa" | Species == "versicolor")
> a$Species <- factor(a$Species )
> str(a)
'data.frame':	100 obs. of  5 variables:
 $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : Factor w/ 2 levels "setosa","versicolor": 1 1 1 1 1 1 1 1 1 1 ... 
```
- 이 결과에서 Species는 Factor형 변수
- setosa : Y=1
- versicolor : Y=2
- 로지스틱 회귀가 적용될 때, 보다 큰 숫자인 versicolor일 오즈를 모형화하므로 해석에 유의할 필요가 있음
```
> b <- glm(Species~Sepal.Length, data=a, family=binomial) # check option family # glm() 함수 이용하여 로지스틱 회귀모형 적합
> summary(b) # summary model

Call:
glm(formula = Species ~ Sepal.Length, family = binomial, data = a)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.05501  -0.47395  -0.02829   0.39788   2.32915  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -27.831      5.434  -5.122 3.02e-07 ***
Sepal.Length    5.140      1.007   5.107 3.28e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 138.629  on 99  degrees of freedom
Residual deviance:  64.211  on 98  degrees of freedom
AIC: 68.211

Number of Fisher Scoring iterations: 6
```
- 회귀계수의 검정에서 p-값이 거의 0이므로 **Sepal.Length**가 매우 유의한 변수이며, Sepal.Length가 한 단위 증가함에 따라 versicolor(Y=2)일 오즈가 exp(5.140), 대략 170배 증가함을 알 수 있다.
- Null deviance : 절편만 포함하는 모형($H_0:\beta=0$하의 모형)의 완전모형으로부터의 이탈도(deviance), 위 결과에서는 p-값=$P(\chi^2(99)>138.629)=0.005$으로 통계적으로 유의하므로 **적합 결여**를 나타냄.
- Residual deviance : 예측변수 Sepal.Length가 추가된 적합모형의 이탈도. Null deviance에 비해 자유도 1 기준에 이탈도 감소가 74.4 정도의 큰 감소를 보이며 p-값=$P(\chi^2(98)>64.211)=0.997$이므로 귀무가설(적합모형)이 기각되지 않고 잘 적합하고 있다고 할 수 있다.



