---
layout: post  
title: "[ë°ì´í„°ë§ˆì´ë‹] 4ì¥. ì˜ì‚¬ê²°ì •ë‚˜ë¬´"
date: 2022-10-30
excerpt: "R ë°ì´í„°ë§ˆì´ë‹ì˜ 4ì¥ ë‚´ìš©ì„ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤."
tag:
- ë°ì´í„°ë§ˆì´ë‹
comments: true
--- 

# 4.1 ì„œë¡ (ì˜ì‚¬ê²°ì •ë‚˜ë¬´ = ë‚˜ë¬´ëª¨í˜•)

---

- ì˜ì‚¬ê²°ì •ê·œì¹™ì„ ë‚˜ë¬´ êµ¬ì¡°ë¡œ ë‚˜íƒ€ë‚´ì–´ ì „ì²´ ìë£Œë¥¼ ëª‡ ê°œì˜ ì†Œì§‘ë‹¨ìœ¼ë¡œ ë¶„ë¥˜í•˜ê±°ë‚˜ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•
- ìƒìœ„ ë…¸ë“œë¡œë¶€í„° í•˜ìœ„ë…¸ë“œë¡œ íŠ¸ë¦¬êµ¬ì¡°ë¥¼ í˜•ì„±í•˜ëŠ” ë§¤ ë‹¨ê³„ë§ˆë‹¤ ë¶„ë¥˜ë³€ìˆ˜ì™€ ë¶„ë¥˜ ê¸°ì¤€ê°’ì˜ ì„ íƒì´ ì¤‘ìš”
- ìƒìœ„ë…¸ë“œì—ì„œì˜ **ë¶„ë¥˜ë³€ìˆ˜, ë¶„ë¥˜ ê¸°ì¤€ê°’**ì€ ì´ ê¸°ì¤€ì— ì˜í•´ ë¶„ê¸°ë˜ëŠ” í•˜ìœ„ë…¸ë“œì—ì„œ **ë…¸ë“œ(ì§‘ë‹¨) ë‚´ì—ì„œëŠ” ë™ì§ˆì„±ì´**, **ë…¸ë“œ(ì§‘ë‹¨) ê°„ì—ëŠ” ì´ì§ˆì„±ì´** ì»¤ì§€ë„ë¡ ì„ íƒ
- ë‚˜ë¬´ëª¨í˜• í¬ê¸°ëŠ” ê³¼ëŒ€ì í•© í˜¹ì€ ê³¼ì†Œì í•©ì´ ë˜ì§€ ì•Šë„ë¡ í•©ë¦¬ì  ê¸°ì¤€ì— ì˜í•´ ì ë‹¹íˆ ì¡°ì ˆë˜ì–´ì•¼ í•¨
- ì˜ˆ. ê³ ê° íƒ€ê²ŸíŒ…, ê³ ê°ë“¤ì˜ ì‹ ìš©ì ìˆ˜í™”, ìº í˜ì¸ ë°˜ì‘ë¶„ì„, ê³ ê°í–‰ë™ì˜ˆì¸¡, ê³ ê° ì„¸ë¶„í™” ë“±

# 4.2 ì˜ì‚¬ê²°ì •ë‚˜ë¬´

---

- ë¿Œë¦¬ë…¸ë“œ : ë§¨ ìœ„, ë¶„ë¥˜(or ì˜ˆì¸¡) ëŒ€ìƒì´ ë˜ëŠ” ëª¨ë“  ìë£Œì§‘ë‹¨ì„ í¬í•¨
- ë¶€ëª¨ë…¸ë“œ(ë§ˆë””) : ìƒìœ„ ë…¸ë“œê°€ í•˜ìœ„ë…¸ë“œë¡œ ë¶„ê¸°ë  ë•Œì˜ ìƒìœ„ ë…¸ë“œ
- ìì‹ë…¸ë“œ(ë§ˆë””) : ìœ„ì—ì„œì˜ í•˜ìœ„ë…¸ë“œ
- ìµœì¢…ë…¸ë“œ(terminal node) : ë” ì´ìƒ ë¶„ê¸°ë˜ì§€ ì•ŠëŠ” ë…¸ë“œ
- ê°€ì§€ë¶„í• (split) : ë‚˜ë¬´ì˜ ê°€ì§€ë¥¼ ìƒì„±í•˜ëŠ” ê³¼ì •
- ê°€ì§€ì¹˜ê¸°(pruning) : ìƒì„±ëœ ê°€ì§€ë¥¼ ì˜ë¼ë‚´ì–´ ëª¨í˜•ì„ ë‹¨ìˆœí™” í•˜ëŠ” ê³¼ì •(**ê³¼ì í•© ë°©ì§€**). ë¶„ë¥˜ëœ ê´€ì¸¡ê°’ì˜ ë¹„ìœ¨ ë˜ëŠ” MSE(Mean Squared Error) ë“±ì„ ê³ ë ¤í•˜ì—¬ ìˆ˜ì¤€ì˜ ê°€ì§€ì¹˜ê¸° ê·œì¹™ ì œê³µí•´ì•¼ í•¨.
- ì •ì§€ê·œì¹™(stopping rule) : ë” ì´ìƒ ë¶„ë¦¬ê°€ ì¼ì–´ë‚˜ì§€ ì•Šê³  í˜„ì¬ì˜ ë§ˆë””ê°€ ëë§ˆë””ê°€ ë˜ë„ë¡ í•˜ëŠ” ì—¬ëŸ¬ ê·œì¹™. ìµœëŒ€ ë‚˜ë¬´ì˜ ê¹Šì´, ìì‹ë§ˆë””ì˜ ìµœì†Œ ê´€ì¸¡ê°’ ìˆ˜, ì¹´ì´ì œê³±í†µê³„ëŸ‰, ì§€ë‹ˆ ì§€ìˆ˜, ì—”íŠ¸ë¡œí”¼ ì§€ìˆ˜ ë“±ì´ ìˆìŒ

## âœ… ì˜ì‚¬ê²°ì •ë‚˜ë¬´ ì¢…ë¥˜
- ëª©í‘œë³€ìˆ˜ê°€ ì´ì‚°í˜•ì¸ ê²½ìš° : ë¶„ë¥˜ë‚˜ë¬´
- ëª©í‘œë³€ìˆ˜ê°€ ì—°ì†í˜•ì¸ ê²½ìš° : íšŒê·€ë‚˜ë¬´

### âœ”ï¸ ë¶„ë¥˜ë‚˜ë¬´
- ë¶„ë¥˜(ê¸°ì¤€) ë³€ìˆ˜ì™€ ë¶„ë¥˜ ê¸°ì¤€ê°’ ì„ íƒ ë°©ë²• : ì¹´ì´ì œê³± í†µê³„ëŸ‰ì˜ p-ê°’, ì§€ë‹ˆ ì§€ìˆ˜, ì—”íŠ¸ë¡œí”¼ ì§€ìˆ˜ ë“±
- ë¶„í• ì´ ì¼ì–´ë‚  ë•Œ ì¹´ì´ì œê³±í†µê³„ëŸ‰ **p-ê°’ì€ ê·¸ ê°’ì´ ì‘ì„ìˆ˜ë¡ ìì‹ ë…¸ë“œ ê°„ ì´ì§ˆì„±ì´ í¼**
- ìì‹ë…¸ë“œì—ì„œ ì§€ë‹ˆ ì§€ìˆ˜ë‚˜ ì—”íŠ¸ë¡œí”¼ ì§€ìˆ˜ëŠ” **ê°’ì´ í´ìˆ˜ë¡ ìì‹ë…¸ë“œ ë‚´ì˜ ì´ì§ˆì„±ì´ í¼ = ë¶ˆí™•ì‹¤ì„±ì´ í¼**, ë”°ë¼ì„œ ì´ ê°’ë“¤ì´ **ì‘ì•„ì§€ëŠ” ë°©í–¥ìœ¼ë¡œ ê°€ì§€ë¶„í•  ìˆ˜í–‰**
- **ë‚®ì€ ìˆœìˆ˜ë„ = ë†’ì€ ì´ì§ˆì„±**

### â­ ë¶ˆí™•ì‹¤ì„± ì¸¡ë„(uncertainty measure)

- ì‹ë“¤ì—ì„œ cëŠ” ëª©í‘œë³€ìˆ˜ì˜ ë²”ì£¼ì˜ ìˆ˜ì´ë©°, ê° ì§€ìˆ˜ì˜ ë²”ìœ„ëŠ” c=2ì¸ ê²½ìš°ì— í•´ë‹¹

### 1ï¸âƒ£ ì§€ë‹ˆì§€ìˆ˜
![](https://user-images.githubusercontent.com/77424107/198869506-4af1522d-d537-4efa-b415-e8e82291bbc6.png)

#### ğŸ’œ ì˜ˆì‹œ
![](https://user-images.githubusercontent.com/77424107/198869569-3a090cf5-3653-4cea-ba9c-48ed666532ed.png)
 
### 2ï¸âƒ£ ì—”íŠ¸ë¡œí”¼ ì§€ìˆ˜
![](https://user-images.githubusercontent.com/77424107/198869644-0aef7c71-da89-444d-9335-27ecb7ecab7f.png)

### 3ï¸âƒ£ ì •ë³´ì´ë“(IA)
$$IA(S,A) = I(S) - I(A)$$
- ìƒìœ„ë…¸ë“œì˜ ì—”íŠ¸ë¡œí”¼ì—ì„œ í•˜ìœ„ë…¸ë“œì˜ ì—”íŠ¸ë¡œí”¼ë¥¼ ëº€ ê°’

## cf) ì§€ë‹ˆì§€ìˆ˜ì™€ ì¹´ì´ì œê³±í†µê³„ëŸ‰ ê³„ì‚° ì˜ˆì‹œ
![](https://user-images.githubusercontent.com/77424107/198883042-c16a71c8-ec4e-433b-8dbe-63adfba0d96d.png)

### âœ”ï¸ íšŒê·€ë‚˜ë¬´
- ë¶„ë¥˜ë³€ìˆ˜ì™€ ë¶„ë¥˜ ê¸°ì¤€ê°’ì˜ ì„ íƒë°©ë²•ìœ¼ë¡œ **F-í†µê³„ëŸ‰ì˜ F-ê°’, ë¶„ì‚°ì˜ ê°ì†ŒëŸ‰** ë“±ì´ ì‚¬ìš©

#### â­ F-í†µê³„ëŸ‰
- ì¼ì›ë°°ì¹˜ë²•ì—ì„œì˜ ê²€ì •í†µê³„ëŸ‰
- ê°’ì´ í´ìˆ˜ë¡ ì˜¤ì°¨ì˜ ë³€ë™ì— ë¹„í•´ ì²˜ë¦¬ì˜ ë³€ë™ì´ í¬ë‹¤ëŠ” ê²ƒ ì˜ë¯¸ = ìì‹ë…¸ë“œ(ì²˜ë¦¬ë“¤) ê°„ì´ ì´ì§ˆì ì„ì„ ì˜ë¯¸
- ì´ ê°’ì´ ì»¤ì§€ëŠ”(p-ê°’ì€ ì‘ì•„ì§€ëŠ”) ë°©í–¥ìœ¼ë¡œ ê°€ì§€ë¶„í• ì„ ìˆ˜í–‰

#### â­ ë¶„ì‚°ì˜ ê°ì†ŒëŸ‰
- ê°’ì´ ìµœëŒ€í™”ë˜ëŠ” ë°©í–¥ìœ¼ë¡œ ê°€ì§€ë¶„í•  ìˆ˜í–‰

## âœ… ì˜ì‚¬ê²°ì •ë‚˜ë¬´ ë¶„ì„ ê³¼ì •

### ë‹¨ê³„ 1. ëª©í‘œë³€ìˆ˜ì™€ ê´€ê³„ ìˆëŠ” ì„¤ëª…ë³€ìˆ˜ë“¤ ì„ íƒ
### ë‹¨ê³„ 2. ë¶„ì„ëª©ì ê³¼ ìë£Œì˜ êµ¬ì¡°ì— ë”°ë¼ ì ì ˆí•œ ë¶„ë¦¬ê¸°ì¤€ê³¼ ì •ì§€ê·œì¹™ì„ ì •í•˜ì—¬ ì˜ì‚¬ê²°ì •ë‚˜ë¬´ ìƒì„±
### ë‹¨ê³„ 3. ë¶€ì ì ˆí•œ ë‚˜ë­‡ê°€ì§€ëŠ” ì œê±°(ê°€ì§€ì¹˜ê¸°)
### ë‹¨ê³„ 4. ì´ìµ, ìœ„í—˜, ë¹„ìš© ë“±ì„ ê³ ë ¤í•˜ì—¬ **ëª¨í˜•í‰ê°€** (êµì°¨íƒ€ë‹¹ì„± ë°©ë²•ë„ ì‚¬ìš©ë¨)
### ë‹¨ê³„ 5. ë¶„ë¥˜ ë° ì˜ˆì¸¡ ìˆ˜í–‰

## âœ… ì˜ì‚¬ê²°ì •ë‚˜ë¬´ë¶„ì„ ìœ„í•œ ì•Œê³ ë¦¬ì¦˜ê³¼ ë¶„ë¥˜ ê¸°ì¤€ë³€ìˆ˜ì˜ ì„ íƒë²•
![](https://user-images.githubusercontent.com/77424107/198883396-4b5efdde-2df9-4cea-86e1-ea0e15c395dc.png)

### ì˜ˆì œ 1) R íŒ¨í‚¤ì§€ {rpart}ì˜ rpart() í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ì˜ì‚¬ê²°ì •ë‚˜ë¬´ ë¶„ì„ì„ ìˆ˜í–‰í•´ë³´ê¸° (iris ìë£Œ ì´ìš©)
- rpart(recursive patitioning and regression tree)
```
> library(rpart)
> c <- rpart(Species ~., data=iris) # rpart{rpart}
> c
n= 150 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

# 100ê°œ ì¤‘ì— setosaê°€ ì•„ë‹Œ ê²ƒ 100ê°œ (ê° ì¢…ë³„ í™•ë¥ ) -> ì´ëŸ°ì‹ìœ¼ë¡œ í•´ê²°í•˜ë©´ ë¨
1) root 150 100 setosa (0.33333333 0.33333333 0.33333333)  
  2) Petal.Length< 2.45 50   0 setosa (1.00000000 0.00000000 0.00000000) *
  3) Petal.Length>=2.45 100  50 versicolor (0.00000000 0.50000000 0.50000000)  
    6) Petal.Width< 1.75 54   5 versicolor (0.00000000 0.90740741 0.09259259) *
    7) Petal.Width>=1.75 46   1 virginica (0.00000000 0.02173913 0.97826087) *
> ls(c)
 [1] "call"                "control"             "cptable"            
 [4] "frame"               "functions"           "method"             
 [7] "numresp"             "ordered"             "parms"              
[10] "splits"              "terms"               "variable.importance"
[13] "where"               "y" 
> plot(c, compress=T, margin=0.3) # ì í•©ëœ ë‚˜ë¬´ëª¨í˜• ì‹œê°í™”
> text(c, cex=1)
```
![](https://user-images.githubusercontent.com/77424107/198884111-535b604a-07a6-415a-87cb-a88be41b6ac8.png)

#### predict í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ìƒˆë¡œìš´ ìë£Œì— ëŒ€í•œ ì˜ˆì¸¡ ìˆ˜í–‰. (í¸ì˜ìƒ ëª¨í˜•êµ¬ì¶•ì— ì‚¬ìš©ëœ ìë£Œë¥¼ ì¬ëŒ€ì…í•œ ê²°ê³¼ ì œì‹œ)
```
> head(predict(c, newdata=iris, type="class"))
     1      2      3      4      5      6 
setosa setosa setosa setosa setosa setosa 
Levels: setosa versicolor virginica
> tail(predict(c, newdata=iris, type="class"))
      145       146       147       148       149       150 
virginica virginica virginica virginica virginica virginica 
Levels: setosa versicolor virginica
```

#### R íŒ¨í‚¤ì§€ {rpart.plot} ì´ìš©í•˜ì—¬ ì í•©ëœ ì˜ì‚¬ê²°ì •ë‚˜ë¬´ëª¨í˜• ì‹œê°í™”
```
library(rpart.plot)
prp(c, type=4, extra =2) # prp{rpart.plot}
```
![image](https://user-images.githubusercontent.com/77424107/198884522-d4f8f2ab-2294-4595-a97b-d27a64cef20a.png)
- í•´ì„ : ë‘ ì¡°ê±´(Petal.Length>=2.4ì™€ Petal.Width<1.8m)ì„ ë§Œì¡±í•˜ëŠ” ë…¸ë“œì—ì„œ 49/54ëŠ” ì´ ë…¸ë“œì— ì†í•˜ëŠ” ê°œì²´ê°€ 54ê°œì´ë©° ì´ ê°€ìš´ë° versicolorì´ 49ì„ì„ ë‚˜íƒ€ëƒ„

#### ls() í•¨ìˆ˜
- $cptable : íŠ¸ë¦¬ í¬ê¸°ì— ë”°ë¥¸ ë¹„ìš©-ë³µì¡ë„ ëª¨ìˆ˜ë¥¼ ì œê³µí•˜ë©°, êµì°¨íƒ€ë‹¹ì„±ì˜¤ì°¨ë¥¼ í•¨ê»˜ ì œê³µ.
- prune() ë˜ëŠ” rpart.control() : ê°€ì§€ì¹˜ê¸°ì™€ íŠ¸ë¦¬ì˜ ìµœëŒ€ í¬ê¸°ë¥¼ ì¡°ì ˆí•˜ê¸° ìœ„í•œ ì˜µì…˜

##### êµì°¨íƒ€ë‹¹ì„±ì˜¤ì°¨ë¥¼ ìµœì†Œë¡œ í•˜ëŠ” íŠ¸ë¦¬ë¥¼ í˜•ì„±í•˜ëŠ” ê³¼ì •
- cp : ë³µì¡ì„±
- nsplit : ê°€ì§€ì˜ ë¶„ê¸° ìˆ˜
- rel error : ì˜¤ë¥˜ìœ¨
- xerror : êµì°¨ê²€ì¦ì˜¤ë¥˜
- xstd : êµì°¨ ê²€ì¦ ì˜¤ë¥˜ì˜ í‘œì¤€ì˜¤ì°¨
```
> c$cptable # cost-complex parameter and cv eroro
    CP nsplit rel error xerror       xstd
1 0.50      0      1.00   1.14 0.05230679
2 0.44      1      0.50   0.68 0.06096994
3 0.01      2      0.06   0.09 0.02908608
> opt <- which.min(c$cptable[,"xerror"]) # xerror(êµì°¨íƒ€ë‹¹ì„±ì˜¤ì°¨)ì„ ìµœì†Œë¡œ í•¨
> cp <- c$cptable[opt, "CP"]# choose CP(=0.01) with min xerror
> prune.c <- prune(c, cp = cp) # prune with CP (with min xerror)
> plot(prune.c)
> text(prune.c, use.n=T)
```
- ìœ„ì˜ rpart()ë¥¼ ìˆ˜í–‰í•œ ê²°ê³¼ì™€ ë™ì¼í•œ ê²°ê³¼

#### {rpart}ì˜ plotcp() í•¨ìˆ˜ ì´ìš© : cp ê°’ì„ ê·¸ë¦¼ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŒ
```
> plotcp(c)
```
![image](https://user-images.githubusercontent.com/77424107/198885469-2cf7c5f1-afce-4439-aa22-d375a7b6cbc0.png)
- ì„  í•˜ë‹¨ì—ì„œ ì„ ì— ê°€ê¹Œìš´ í¬ì¸íŠ¸ì˜ yì¶•(ì•½ 0.01)ì„ ì„ íƒ. ì„  í•˜ë‹¨ì˜ ê°€ì¥ ì™¼ìª½ì— ìœ„ì¹˜í•œ í¬ì¸íŠ¸ì˜ cpë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì´ ë°”ëŒì§.

### ì˜ˆì œ 2) **{party}ì˜ ctree()í•¨ìˆ˜ ì´ìš©í•˜ì—¬ ì í•© : ë¶„ì„ì— ì‚¬ìš©ëœ ìë£ŒëŠ” 146ëª…ì˜ ì „ë¦½ì„  ì•” í™˜ìì˜ ìë£Œ(stagec)ì—ì„œ 7ê°œì˜ ì˜ˆì¸¡ë³€ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë²”ì£¼í˜• ë°˜ì‘ë³€ìˆ˜(ploidy)ë¥¼ ì˜ˆì¸¡(ë˜ëŠ” ë¶„ë¥˜)
```
> library(party)
> data(stagec)
> str(stagec)
'data.frame':	146 obs. of  8 variables:
 $ pgtime : num  6.1 9.4 5.2 3.2 1.9 4.8 5.8 7.3 3.7 15.9 ...
 $ pgstat : int  0 0 1 1 1 0 0 0 1 0 ...
 $ age    : int  64 62 59 62 64 69 75 71 73 64 ...
 $ eet    : int  2 1 2 2 2 1 2 2 2 2 ...
 $ g2     : num  10.26 NA 9.99 3.57 22.56 ...
 $ grade  : int  2 3 3 2 4 3 2 3 3 3 ...
 $ gleason: int  4 8 7 4 8 7 NA 7 6 7 ...
 $ ploidy : Factor w/ 3 levels "diploid","tetraploid",..: 1 3 1 1 2 1 2 3 1 2 ...
```
#### ğŸ’œ ê²°ì¸¡ê°’ ì œê±°
```
> # subsitution missing value
> stagec1<- subset(stagec, !is.na(g2))
> stagec2<- subset(stagec1, !is.na(gleason))
> stagec3<- subset(stagec2, !is.na(eet))
> str(stagec3)
'data.frame':	134 obs. of  8 variables:
 $ pgtime : num  6.1 5.2 3.2 1.9 4.8 3.7 15.9 6.3 2.9 1.5 ...
 $ pgstat : int  0 1 1 1 0 1 0 0 1 1 ...
 $ age    : int  64 59 62 64 69 73 64 65 58 70 ...
 $ eet    : int  2 2 2 2 1 2 2 2 2 2 ...
 $ g2     : num  10.26 9.99 3.57 22.56 6.14 ...
 $ grade  : int  2 3 2 4 3 3 3 3 4 3 ...
 $ gleason: int  4 7 4 8 7 6 7 7 8 8 ...
 $ ploidy : Factor w/ 3 levels "diploid","tetraploid",..: 1 1 1 2 1 1 2 2 2 1 ...
```
- ê²°ì¸¡ê°’ì´ ì œê±°ëœ 134ê°œì˜ ìë£Œë¥¼ ì´ìš©í•˜ì—¬ ëª¨í˜• ì í•©

#### ğŸ’œ ëª¨í˜•êµ¬ì¶•ì„ ìœ„í•œ í›ˆë ¨ìš© ìë£Œ(train data)ì™€ ëª¨í˜•ì˜ ì„±ëŠ¥ì„ ê²€ì¦í•˜ê¸° ìœ„í•œ ê²€ì¦ë£¡ ìë£Œ(test data)ë¥¼ 70%, 30%ë¡œ êµ¬ì„±
- ëª¨í˜• ë§Œë“¤ê¸° ì „ì— stagec ìë£Œë¥¼ ë³µì›ì¶”ì¶œë°©ë²•ì„ ì´ìš©í•˜ì—¬ ë‘ ê°œì˜ ë¶€ë¶„ì§‘í•© training(70%)ì™€ test(30%)ë¡œ ë§Œë“¤ê³  ê²°ê³¼ì˜ ì¬í˜„ì„±ì„ ìœ„í•´ random seedë¥¼ ê³ ì •
```
> # divid trining:test=7:3
> set.seed(1234)
> ind <- sample(2, nrow(stagec3), replace=TRUE, prob=c(0.7, 0.3))
> ind
  [1] 1 1 1 1 2 1 1 1 1 1 1 1 1 2 1 2 1 1 1 1 1 1 1 1 1 2 1 2 2 1 1 1 1 1 1 2 1
 [38] 1 2 2 1 1 1 1 1 1 1 1 1 2 1 1 2 1 1 1 1 2 1 2 2 1 1 1 1 2 1 1 1 1 1 2 1 2
 [75] 1 1 1 1 1 1 2 1 1 1 1 2 1 1 1 2 1 2 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 2
[112] 1 2 1 1 2 2 1 1 2 2 2 2 2 1 1 1 1 1 1 2 1 1 1
> trainData <- stagec3[ind==1, ] # n=102ê°œ
> testData <- stagec3[ind==2, ] # n=32ê°œ
```

#### ğŸ’œ í›ˆë ¨ìš© ìë£Œì— ëŒ€í•´ ctree() ì ìš©
```
> tree <- ctree(ploidy ~ ., data=trainData)
> tree

	 Conditional inference tree with 3 terminal nodes

Response:  ploidy 
Inputs:  pgtime, pgstat, age, eet, g2, grade, gleason 
Number of observations:  102 

1) g2 <= 13.01; criterion = 1, statistic = 49.684
  2) pgstat <= 0; criterion = 0.958, statistic = 7.5
    3)*  weights = 36 
  2) pgstat > 0
    4)*  weights = 15 
1) g2 > 13.01
  5)*  weights = 51 
> plot(tree)
```
![image](https://user-images.githubusercontent.com/77424107/198887694-e4393885-bcdb-4b3d-877c-d133c7b58892.png)
- ìµœì¢…ë…¸ë“œì˜ ë§‰ëŒ€ê·¸ë˜í”„ëŠ” ë°˜ì‘ë³€ìˆ˜ì˜ ê° ë²”ì£¼ë³„ ë¹„ìœ¨ì„ ë‚˜íƒ€ëƒ„

#### ğŸ’œ predict() í•¨ìˆ˜ë¥¼ í†µí•´ ê²€ì¦ìš© ìë£Œì— ëŒ€í•´ ì í•©ëª¨í˜• ì ìš©
```
> testPred = predict(tree, newdata=testData)
> table(testPred, testData$ploidy) # confusion table
            
testPred     diploid tetraploid aneuploid
  diploid         17          0         1
  tetraploid       0         13         1
  aneuploid        0          0         0
  ```

  ### ì˜ˆì œ 3) ctree() í•¨ìˆ˜ ì´ìš©í•˜ì—¬ ë°˜ì‘ë³€ìˆ˜ê°€ ì—°ì†í˜•ì¸ ê²½ìš° íšŒê·€ë‚˜ë¬´ë¥¼ í†µí•œ ì˜ˆì¸¡ ìˆ˜í–‰ : airquality ìë£Œì— ëŒ€í•´ ì˜ì‚¬ê²°ì •ë‚˜ë¬´ë¥¼ ì í•©. ë°˜ì‘ë³€ìˆ˜ Ozoneì´ ê²°ì¸¡ì¸ ìë£Œë¥¼ ì œì™¸í•œ í›„ ctree() í•¨ìˆ˜ë¥¼ ì ìš©
  ```
  > airq <- subset(airquality, !is.na(Ozone))
> head(airq)
  Ozone Solar.R Wind Temp Month Day
1    41     190  7.4   67     5   1
2    36     118  8.0   72     5   2
3    12     149 12.6   74     5   3
4    18     313 11.5   62     5   4
6    28      NA 14.9   66     5   6
7    23     299  8.6   65     5   7
> airct <- ctree(Ozone ~ ., data=airq) 
> airct

	 Conditional inference tree with 5 terminal nodes

Response:  Ozone 
Inputs:  Solar.R, Wind, Temp, Month, Day 
Number of observations:  116 

1) Temp <= 82; criterion = 1, statistic = 56.086
  2) Wind <= 6.9; criterion = 0.998, statistic = 12.969
    3)*  weights = 10 
  2) Wind > 6.9
    4) Temp <= 77; criterion = 0.997, statistic = 11.599
      5)*  weights = 48 
    4) Temp > 77
      6)*  weights = 21 
1) Temp > 82
  7) Wind <= 10.3; criterion = 0.997, statistic = 11.712
    8)*  weights = 30 
  7) Wind > 10.3
    9)*  weights = 7 
```

#### ğŸ’œ ìµœì¢…ë…¸ë“œ(*ë¡œ í‘œì‹œëœ ë§ˆë””)ê°€ 5ê°œì¸ íŠ¸ë¦¬ë¥¼ ì‹œê°í™”
```
> plot(airct)
```
![image](https://user-images.githubusercontent.com/77424107/198888508-923bdfd9-acbc-41da-89a8-e34ff7bc9604.png)

#### ğŸ’œ predict() í•¨ìˆ˜ë¡œ ìƒˆë¡œìš´ ìë£Œì— ëŒ€í•œ ì˜ˆì¸¡ ìˆ˜í–‰
```
> head(predict(airct, data=airq))
        Ozone
[1,] 18.47917
[2,] 18.47917
[3,] 18.47917
[4,] 18.47917
[5,] 18.47917
[6,] 18.47917
```

#### ğŸ’œ ìë£Œê°€ ì†í•˜ëŠ” í•´ë‹¹ ìµœì¢…ë…¸ë“œì˜ ë²ˆí˜¸ ì¶œë ¥í•  ë•Œ : type='node' ì˜µì…˜ ì ìš©
```
> predict(airct, data=airq, type="node")
  [1] 5 5 5 5 5 5 5 5 3 5 5 5 5 5 5 5 5 5 5 5 5 5 5 6 3 5 6 9 9 6 5 5 5 5 5 8 8
 [38] 6 8 9 8 8 8 8 5 6 6 3 6 8 8 9 3 8 8 6 9 8 8 8 6 3 6 6 8 8 8 8 8 8 9 6 6 5
 [75] 3 5 6 6 5 5 6 3 8 8 8 8 8 8 8 8 8 8 9 6 6 5 5 6 5 3 5 5 3 5 5 5 6 5 5 6 5
[112] 5 3 5 5 5
```

#### ğŸ’œ ì˜ˆì¸¡ê°’ì„ ì´ìš©í•˜ì—¬ í‰ê· ì œê³±ì˜¤ì°¨ êµ¬í•˜ê¸°
```
> mean((airq$Ozone - predict(airct))^2) # mean square error
[1] 403.6668
```

# â­ ì˜ì‚¬ê²°ì •ë‚˜ë¬´ëª¨í˜•ì˜ ì¥ë‹¨ì 

---

## âœ… ì¥ì 
- êµ¬ì¡°ê°€ ë‹¨ìˆœí•˜ì—¬ í•´ì„ì´ ìš©ì´
- ìœ ìš©í•œ ì…ë ¥ë³€ìˆ˜ì˜ íŒŒì•…ê³¼ ì˜ˆì¸¡ë³€ìˆ˜ ê°„ ìƒí˜¸ì‘ìš© ë° ë¹„ì„ í˜•ì„±ì„ ê³ ë ¤í•˜ì—¬ ë¶„ì„ì´ ìˆ˜í–‰ë¨
- ì„ í˜•ì„±, ì •ê·œì„±, ë“±ë¶„ì‚°ì„± ë“±ì˜ ìˆ˜í•™ì  ê°€ì • ë¶ˆí•„ìš”

## âœ… ë‹¨ì 
- ë¶„ë¥˜ ê¸°ì¤€ê°’ì˜ ê²½ê³„ì„  ê·¼ë°©ì˜ ìë£Ÿê°’ì— ëŒ€í•´ì„œëŠ” ì˜¤ì°¨ê°€ í´ ìˆ˜ ìˆìŒ(ë¹„ì—°ì†ì„±)
- ë¡œì§€ìŠ¤í‹± íšŒê·€ì™€ ê°™ì´ ê° ì˜ˆì¸¡ë³€ìˆ˜ì˜ íš¨ê³¼ë¥¼ íŒŒì•…í•˜ê¸° ì–´ë ¤ì›€
- ìƒˆë¡œìš´ ìë£Œì— ëŒ€í•œ ì˜ˆì¸¡ì´ ë¶ˆì•ˆì •í•  ìˆ˜ ìˆìŒ