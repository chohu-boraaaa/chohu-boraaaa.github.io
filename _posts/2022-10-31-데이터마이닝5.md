---
layout: post  
title: "[ë°ì´í„°ë§ˆì´ë‹] 5ìž¥. ë‹¨ìˆœ ë² ì´ì¦ˆ ë¶„ë¥˜"
date: 2022-10-30
excerpt: "R ë°ì´í„°ë§ˆì´ë‹ì˜ 5ìž¥ ë‚´ìš©ì„ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤."
tag:
- ë°ì´í„°ë§ˆì´ë‹
comments: true
--- 

# 5.1 ì„œë¡ 

---

- ë‹¨ìˆœ ë² ì´ì¦ˆ ë¶„ë¥˜(naive Bayes classification) ëª¨í˜•ì€ ë² ì´ì¦ˆ ì •ë¦¬ì— ê¸°ë°˜í•œ ë°©ë²•
- ì‚¬í›„í™•ë¥ (ì¼ì¢…ì˜ ì¡°ê±´ë¶€ ê²°í•©í™•ë¥ ) ê³„ì‚°ì‹œ ì¡°ê±´ë¶€ ë…ë¦½ì„ ê°€ì •í•˜ì—¬ ê³„ì‚°ì„ ë‹¨ìˆœí™”í•œ ë°©ë²•
- ì‚¬í›„í™•ë¥ ì´ í° ì§‘ë‹¨ìœ¼ë¡œ ìƒˆë¡œìš´ ë°ì´í„° ë¶„ë¥˜
- ì¡°ê±´ë¶€ ë…ë¦½ì˜ ê°€ì •ì´ ë¹„í˜„ì‹¤ì  ì¸¡ë©´ì´ ìžˆì§€ë§Œ ê³„ì‚°ì´ ê°„íŽ¸í•˜ì—¬ ë„ë¦¬ ì´ìš©ë¨
- ë¬¸ì„œë¶„ë¥˜(spam or legitimate, sports or politics ë“±), ì˜ë£Œì§„ë‹¨ ë“±ì— ë§Žì´ ì‚¬ìš©
- ì ì ˆí•œ ì „ì²˜ë¦¬ ê³¼ì •ì„ ê±°ì¹œ ë‹¨ìˆœ ë² ì´ì¦ˆ ë¶„ë¥˜ëŠ” ì„œí¬íŠ¸ë²¡í„°ë¨¸ì‹ ì„ í¬í•¨í•œ ë³´ë‹¤ ë°œì „ëœ ê¸°ë²•ê³¼ë„ ê²½ìŸ

# 5.2 ë‹¨ìˆœ ë² ì´ì¦ˆ ë¶„ë¥˜

---

- ì—°ì†í˜• ë˜ëŠ” ì´ì‚°í˜•ì— ê´€ê³„ì—†ì´ ìž„ì˜ í¬ê¸°ì˜ ì˜ˆì¸¡ë³€ìˆ˜ ë‹¤ë£° ìˆ˜ ìžˆìŒ
- ë°ì´í„°ê°€ ë‹¤ìŒê³¼ ê°™ì´ ì£¼ì–´ì§ˆ ë•Œ
$$x=(x_1, x_2, ..., x_d)$$
- ì´ ë°ì´í„°ê°€ C_j ì§‘ë‹¨ìœ¼ë¡œë¶€í„° ë‚˜ì™”ì„ ì‚¬í›„í™•ë¥ ì€ ë² ì´ì¦ˆ ì •ë¦¬ë¡œë¶€í„° ë‹¤ìŒê³¼ ê°™ë‹¤.
![](https://user-images.githubusercontent.com/77424107/198889294-bd0c1859-7534-4ae3-9196-868e725e5fa5.png)
- ìœ„ì˜ ì‚¬í›„í™•ë¥ ì˜ ê³„ì‚°ì„ ì¢€ ë” íŽ¸í•˜ê²Œ í•  ìˆ˜ ìžˆë„ë¡ ì˜ˆì¸¡ë³€ìˆ˜ë“¤ ê°„ ë…ë¦½ì„ ê°€ì •
![](https://user-images.githubusercontent.com/77424107/198889378-6cff5398-3d6e-4d34-9ecc-c147b16ed8a9.png)
- ìœ„ì˜ ì‹ì„ ì´ìš©í•˜ì—¬ **ì‚¬í›„í™•ë¥ ì˜ ë¶„ìžë¥¼ ê³„ì‚°í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ì´ìš©í•˜ì—¬ ë¶„ë¥˜ë¥¼ ìˆ˜í–‰**

## ì‚¬ë¡€ 1) ë¬¸ì„œë¶„ë¥˜ì™€ ê´€ë ¨ëœ ì˜ˆì œ
![](https://user-images.githubusercontent.com/77424107/198890376-1d521669-6fe8-4c91-ad68-6070035d9acf.png)

- ë”°ë¼ì„œ, ìž…ë ¥ë¬¸ì„œëŠ” ì‚¬í›„í™•ë¥ ì´ ë” í° actionìœ¼ë¡œ ë¶„ë¥˜ë¨

### â—ì£¼ì˜ : ë‚®ì€-ë¹ˆë„ ë¬¸ì œ(low-frequency problem)
- ìœ„ì˜ ì˜ˆì—ì„œ comdeyì—ì„œ furious ë‹¨ì–´ ë¹ˆë„ê°€ 0ì´ë¯€ë¡œ, furious ë‹¨ì–´ë¥¼ í¬í•¨í•˜ëŠ” ìƒˆë¡œìš´ ìžë£ŒëŠ” í•­ìƒ ì‚¬í›„í™•ë¥ ì´ 0ì´ ë˜ì–´ ë²„ë¦¼.
- ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ **ëª¨ë“  ì†ì„±ê°’-êµ°ì§‘ ì¡°í•©ì— ëŒ€í•œ ë¹ˆë„ì— ìž‘ì€ ìˆ˜ë¥¼ ë”í•´ì£¼ì–´ ê³„ì‚° ìˆ˜í–‰**

## ì‚¬ë¡€ 2) ì—¬ëŸ¬ ê°œ ì—°ì†í˜• ì˜ˆì¸¡ë³€ìˆ˜ë¥¼ ê°€ì§€ëŠ” ê²½ìš°
```
> (height1 <- dnorm(6, mean=5.855, sd=sqrt(0.035033)))
[1] 1.578886
> weight1 <- dnorm(130, mean=176.26, sd=sqrt(122.92))
> feet1 <- dnorm(8, mean=11.25, sd=sqrt(0.91667))
> m.x <- 0.5*height1*weight1*feet1  # p(ë‚¨ì„±|x)
> m.x
[1] 6.175299e-09
> height2 <- dnorm(6, mean=5.4175, sd=sqrt(0.097225))
> weight2 <- dnorm(130, mean=132.5, sd=sqrt(558.33))
> feet2 <- dnorm(8, mean=7.5, sd=sqrt(1.6667))
> f.x <- 0.5 * height2 * weight2 * feet2 # p(ì—¬ì„±|x)
> f.x
[1] 0.0005377879
```
![](https://user-images.githubusercontent.com/77424107/198890729-4d794f8d-8214-4ebd-98d8-f24c36eb8a26.png)

## ì˜ˆì œ 1) íŒ¨í‚¤ì§€ {e1017} ì´ìš© : ë‹¨ìˆœ ë² ì´ì¦ˆ ë¶„ì„ - iris ìžë£Œ
```
> data(iris)
> head(iris)
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa
```
### ðŸ’œ RíŒ¨í‚¤ì§€ {e1071}ì˜ naiveBayes() í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë‹¨ìˆœ ë² ì´ì¦ˆ ë¶„ë¥˜ ìˆ˜í–‰
```
> library(e1071)
> m <- naiveBayes(Species ~ ., data = iris)
> m

Naive Bayes Classifier for Discrete Predictors

Call:
naiveBayes.default(x = X, y = Y, laplace = laplace)

A-priori probabilities:
Y
    setosa versicolor  virginica 
 0.3333333  0.3333333  0.3333333 

Conditional probabilities:
            Sepal.Length
Y             [,1]      [,2]
  setosa     5.006 0.3524897 # í‰ê· , í‘œì¤€íŽ¸ì°¨
  versicolor 5.936 0.5161711
  virginica  6.588 0.6358796

            Sepal.Width
Y             [,1]      [,2]
  setosa     3.428 0.3790644
  versicolor 2.770 0.3137983
  virginica  2.974 0.3224966

            Petal.Length
Y             [,1]      [,2]
  setosa     1.462 0.1736640
  versicolor 4.260 0.4699110
  virginica  5.552 0.5518947

            Petal.Width
Y             [,1]      [,2]
  setosa     0.246 0.1053856
  versicolor 1.326 0.1977527
  virginica  2.026 0.2746501
```
### ðŸ’œ predict() í•¨ìˆ˜ ì´ìš©í•˜ì—¬ ì˜ˆì¸¡ ì‹¤ì‹œ ë° ê²°ê³¼ë¥¼ ì •ì˜¤ë¶„ë¥˜í‘œë¡œ ë‚˜íƒ€ë‚´ê¸°
```
> table(predict(m, iris), iris[,5])
            
             setosa versicolor virginica
  setosa         50          0         0
  versicolor      0         47         3
  virginica       0          3        47
```

## ì˜ˆì œ 2) íŒ¨í‚¤ì§€ {klaR}ì„ ì´ìš©í•˜ì—¬ ë‹¨ìˆœë² ì´ì¦ˆ ë¶„ë¥˜ ìˆ˜í–‰ - spam ë©”ì¼ ë¶„ë¥˜ ì˜ˆì œ
```
> data(spam)
> str(spam)
'data.frame':	4601 obs. of  58 variables:
 $ A.1 : num  0 0.21 0.06 0 0 0 0 0 0.15 0.06 ...
 $ A.2 : num  0.64 0.28 0 0 0 0 0 0 0 0.12 ...
 $ A.3 : num  0.64 0.5 0.71 0 0 0 0 0 0.46 0.77 ...
 $ A.4 : num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.5 : num  0.32 0.14 1.23 0.63 0.63 1.85 1.92 1.88 0.61 0.19 ...
 $ A.6 : num  0 0.28 0.19 0 0 0 0 0 0 0.32 ...
 $ A.7 : num  0 0.21 0.19 0.31 0.31 0 0 0 0.3 0.38 ...
 $ A.8 : num  0 0.07 0.12 0.63 0.63 1.85 0 1.88 0 0 ...
 $ A.9 : num  0 0 0.64 0.31 0.31 0 0 0 0.92 0.06 ...
 $ A.10: num  0 0.94 0.25 0.63 0.63 0 0.64 0 0.76 0 ...
 $ A.11: num  0 0.21 0.38 0.31 0.31 0 0.96 0 0.76 0 ...
 $ A.12: num  0.64 0.79 0.45 0.31 0.31 0 1.28 0 0.92 0.64 ...
 $ A.13: num  0 0.65 0.12 0.31 0.31 0 0 0 0 0.25 ...
 $ A.14: num  0 0.21 0 0 0 0 0 0 0 0 ...
 $ A.15: num  0 0.14 1.75 0 0 0 0 0 0 0.12 ...
 $ A.16: num  0.32 0.14 0.06 0.31 0.31 0 0.96 0 0 0 ...
 $ A.17: num  0 0.07 0.06 0 0 0 0 0 0 0 ...
 $ A.18: num  1.29 0.28 1.03 0 0 0 0.32 0 0.15 0.12 ...
 $ A.19: num  1.93 3.47 1.36 3.18 3.18 0 3.85 0 1.23 1.67 ...
 $ A.20: num  0 0 0.32 0 0 0 0 0 3.53 0.06 ...
 $ A.21: num  0.96 1.59 0.51 0.31 0.31 0 0.64 0 2 0.71 ...
 $ A.22: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.23: num  0 0.43 1.16 0 0 0 0 0 0 0.19 ...
 $ A.24: num  0 0.43 0.06 0 0 0 0 0 0.15 0 ...
 $ A.25: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.26: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.27: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.28: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.29: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.30: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.31: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.32: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.33: num  0 0 0 0 0 0 0 0 0.15 0 ...
 $ A.34: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.35: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.36: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.37: num  0 0.07 0 0 0 0 0 0 0 0 ...
 $ A.38: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.39: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.40: num  0 0 0.06 0 0 0 0 0 0 0 ...
 $ A.41: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.42: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.43: num  0 0 0.12 0 0 0 0 0 0.3 0 ...
 $ A.44: num  0 0 0 0 0 0 0 0 0 0.06 ...
 $ A.45: num  0 0 0.06 0 0 0 0 0 0 0 ...
 $ A.46: num  0 0 0.06 0 0 0 0 0 0 0 ...
 $ A.47: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.48: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.49: num  0 0 0.01 0 0 0 0 0 0 0.04 ...
 $ A.50: num  0 0.132 0.143 0.137 0.135 0.223 0.054 0.206 0.271 0.03 ...
 $ A.51: num  0 0 0 0 0 0 0 0 0 0 ...
 $ A.52: num  0.778 0.372 0.276 0.137 0.135 0 0.164 0 0.181 0.244 ...
 $ A.53: num  0 0.18 0.184 0 0 0 0.054 0 0.203 0.081 ...
 $ A.54: num  0 0.048 0.01 0 0 0 0 0 0.022 0 ...
 $ A.55: num  3.76 5.11 9.82 3.54 3.54 ...
 $ A.56: int  61 101 485 40 40 15 4 11 445 43 ...
 $ A.57: int  278 1028 2259 191 191 54 112 49 1257 749 ...
 $ spam: Factor w/ 2 levels "email","spam": 2 2 2 2 2 2 2 2 2 2 ... # ìŠ¤íŒ¸ë©”ì¼ ì—¬ë¶€
> library(klaR)
```

### ðŸ’œ ì „ì²´ ìžë£Œì˜ 2/3ì„ í›ˆë ¨ìš© ìžë£Œë¡œ í•˜ì—¬ NaiveBayes() í•¨ìˆ˜ë¡œ ë‹¨ìˆœ ë² ì´ì¦ˆ ë¶„ë¥˜
```
> train.ind <- sample(1:nrow(spam), ceiling(nrow(spam)*2/3),
+                     replace=FALSE)
> nb.res <- NaiveBayes(spam ~ ., data=spam[train.ind,])
> # ê²°ê³¼
> opar <- par(mfrow=c(2,4))
> plot(nb.res)
```
![](https://user-images.githubusercontent.com/77424107/198974731-fc22e543-2716-42e3-aa1e-9d81ab2cee13.png)
- ìœ„ì˜ ê²°ê³¼(ê·¸ë¦¼)ëŠ” 57ê°œì˜ ì˜ˆì¸¡ë³€ìˆ˜ë³„ ë¶„í¬ë¥¼ ë¬¸ì„œì˜ ì¢…ë¥˜ë³„(spam, non-spam)ë¡œ ê·¸ë¦° ê²ƒ
- ìƒˆë¡œìš´ ìžë£Œê°€ ì£¼ì–´ì§ˆ ë•Œ, ì‚¬í›„í™•ë¥ ì€ ì‚¬ì „í™•ë¥ ê³¼ ìœ„ í™•ë¥ ë“¤ì˜ ê³±ì„ í†µí•´ êµ¬í•  ìˆ˜ ìžˆìŒ

### ðŸ’œ ë¶„ì„ì— ì œì™¸ëœ ê²€ì¦ìš© ìžë£Œë¥¼ ì´ìš©í•˜ì—¬ ëª¨í˜•ì˜ ì •í™•ë„ íŒŒì•…
```
> par(opar)
> nb.pred <- predict(nb.res, spam[-train.ind,])
There were 50 or more warnings (use warnings() to see the first 50)
> confusion.mat <- table(nb.pred$class, spam[-train.ind,"spam"])
> confusion.mat
       
        email spam # ì—´ ë°©í–¥ : ì‹¤ì œ
  email   522   34 # í–‰ ë°©í–¥ : ì˜ˆì¸¡
  spam    420  557
> sum(diag(confusion.mat))/sum(confusion.mat)
[1] 0.7038487
```
- ìœ„ì˜ ê²°ê³¼ë¡œë¶€í„° ì •ë¶„ë¥˜ìœ¨ì€ 70.3%

## âœ… ë‹¨ìˆœ ë² ì´ì¦ˆ ë¶„ë¥˜ì—ì„œì˜ ê²°ì¸¡ê°’ ì²˜ë¦¬
- í›ˆë ¨ë‹¨ê³„ : ì†ì„±ê°’-êµ°ì§‘ ì¡°í•©ì— ëŒ€í•œ ë¹ˆë„ ê³„ì‚° ì‹œ ê²°ì¸¡ê°’ì„ í¬í•¨í•˜ëŠ” ì¼€ì´ìŠ¤ê°€ ì œì™¸ë¨
- ë¶„ë¥˜ë‹¨ê³„ : ê²°ì¸¡ì¸ ì†ì„±ì´ ê³„ì‚°ê³¼ì •ì—ì„œ ìƒëžµ
- ë‹¨ìˆœ ë² ì´ì¦ˆ ë¶„ë¥˜ì—ì„œëŠ” ê²°ì¸¡ê°’ì— ëŒ€í•œ ì²˜ë¦¬ê°€ ë§¤ìš° ìœ ì—°í•¨
- ëª¨í˜•êµ¬ì¶•ì—ì„œëŠ” ê²°ì¸¡ê°’ì„ í¬í•¨í•˜ëŠ” ì¼€ì´ìŠ¤ë¥¼ ì œì™¸í•˜ë©°, ë¶„ë¥˜ê³¼ì •ì—ì„œëŠ” ê²°ì¸¡ ì†ì„±ì— ëŒ€í•œ í™•ë¥ ë§Œ ê³„ì‚°ì—ì„œ ì œì™¸ë˜ë¯€ë¡œ ìˆ˜í–‰ê³¼ì •ì— ë¬¸ì œ ì—†ìŒ

## ì˜ˆì œ 3) ê²°ì¸¡ê°’ì„ í¬í•¨í•˜ëŠ” ìžë£Œì— ëŒ€í•œ ë‹¨ìˆœ ë² ì´ì¦ˆ ë¶„ë¥˜ : ë¯¸êµ­ í•˜ì›ì˜ì› ì£¼ìš”ë²•ì•ˆ ì°¬ë°˜ì—¬ë¶€ ì¡°ì‚¬í•œ ìžë£Œ
```
> library (e1071)
> data (HouseVotes84, package="mlbench")
> head(HouseVotes84)
       Class   V1 V2 V3   V4   V5 V6 V7 V8 V9 V10  V11  V12 V13 V14 V15  V16
1 republican    n  y  n    y    y  y  n  n  n   y <NA>    y   y   y   n    y
2 republican    n  y  n    y    y  y  n  n  n   n    n    y   y   y   n <NA>
3   democrat <NA>  y  y <NA>    y  y  n  n  n   n    y    n   y   y   n    n
4   democrat    n  y  y    n <NA>  y  n  n  n   n    y    n   y   n   n    y
5   democrat    y  y  y    n    y  y  n  n  n   n    y <NA>   y   y   y    y
6   democrat    n  y  y    n    y  y  n  n  n   n    n    n   y   y   y    y
> summary(HouseVotes84)
        Class        V1         V2         V3         V4         V5     
 democrat  :267   n   :236   n   :192   n   :171   n   :247   n   :208  
 republican:168   y   :187   y   :195   y   :253   y   :177   y   :212  
                  NA's: 12   NA's: 48   NA's: 11   NA's: 11   NA's: 15  
    V6         V7         V8         V9        V10        V11        V12     
 n   :152   n   :182   n   :178   n   :206   n   :212   n   :264   n   :233  
 y   :272   y   :239   y   :242   y   :207   y   :216   y   :150   y   :171  
 NA's: 11   NA's: 14   NA's: 15   NA's: 22   NA's:  7   NA's: 21   NA's: 31  
   V13        V14        V15        V16     
 n   :201   n   :170   n   :233   n   : 62  
 y   :209   y   :248   y   :174   y   :269  
 NA's: 25   NA's: 17   NA's: 28   NA's:104  
> 
> model <- naiveBayes(Class ~ ., data = HouseVotes84)
> pred <- predict(model, HouseVotes84[,-1])
> tab <- table(pred, HouseVotes84$Class)
> tab # confusion table
            
pred         democrat republican
  democrat        238         13
  republican       29        155
> table(HouseVotes84$Class) # prior

  democrat republican 
       267        168 
> sum(tab[row(tab)==col(tab)])/sum(tab) # acc
[1] 0.9034483
```